(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["formLoad"],{

/***/ "./app/Resources/assets/js/formLoad.js":
/*!*********************************************!*\
  !*** ./app/Resources/assets/js/formLoad.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function Reveal(size, origin) {
  var el = document.createElement('div');
  el.className = "reveal " + size;
  el.setAttribute("data-reveal", "");
  el.setAttribute("role", "dialog");
  el.setAttribute("data-options", "closeOnClick:false;");
  el.revealobject = this;
  el.innerHTML = '';
  this.origin = origin;
  this.el = document.body.appendChild(el);
  eventListeners(this.el);
  $(this.el).on('closed.zf.reveal', function (event, large) {
    $(this).closest('div.reveal-overlay').remove();
    return false;
  });
  $(this.el).on('closeme.zf.reveal', function (event, large) {
    return false;
  });
}

function changeFormResult() {
  $('form[formresult="json"]').submit(function (e) {
    var formElm = $(this);
    var reveal = $(this).closest('.reveal').get(0).revealobject;
    e.preventDefault();

    try {
      var formUrl = $(formElm).attr('action');
      var formData = $(this).serialize();
      $.ajax({
        type: "POST",
        url: formUrl,
        data: formData,
        async: true,
        success: function success(response) {
          var selectElm = $(reveal.origin).closest('.form-collection-add').find('select').first();
          selectElm.append($('<option>', {
            value: response.id
          }).text(response.name));
          selectElm.val(response.id);
          formElm.closest('.reveal').foundation('close');
        },
        error: function error(XMLHttpRequest, textStatus, errorThrown) {}
      });
    } catch (ex) {
      alert(ex.message);
    }

    return false;
  });
}

function eventListeners(scope) {
  scope = scope || document;
  var dateFormat = 'dd-mm-yy';
  var datepickerSettings = {
    dateFormat: dateFormat,
    showWeek: true,
    numberOfMonths: 1,
    prevText: ' ',
    nextText: ' ',
    weekHeader: ' ',
    firstDay: 1,
    dayNames: ['Zondag', 'Mandaag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrijdag', 'Zaterdag'],
    dayNamesMin: ['Zo', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Za'],
    monthNames: ['Januari', 'Februari', 'Maart', 'April', 'Mei', 'Juni', 'Juli', 'Augustus', 'September', 'Oktober', 'November', 'December'],
    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],
    beforeShow: function beforeShow(input, inst) {
      $('#ui-datepicker-div').addClass('standalone-datepicker');
    }
  };
}

window.Reveal = Reveal;
$(document).ready(function () {
  var pathTouchMoved = false;
  $('body').on('click touchend', '[data-path]', function (e) {
    if (pathTouchMoved != true) {
      e.preventDefault();
      $(this).disabled = true;
      var path = $(this).attr("data-path"); //if (path[0] !== '/')
      //    Routing.generate(path);
      //console.log(path);

      var size = $(this).attr("data-reveal-size");
      var origin = this;
      var reveal = new Reveal(size ? size : 'large', origin);
      var elementToOpen = $(this).attr("data-open-element");
      $.ajax({
        type: 'GET',
        url: path,
        success: function success(data) {
          $(reveal.el).foundation();
          $(reveal.el).html(data).foundation('open');
          $('> div', reveal.el).foundation();
          changeFormResult();
          eventListeners();

          if (elementToOpen) {
            $(elementToOpen).select2('open');
          } else {
            // focus first visible field in form
            $('form').find('*').filter(':input:visible:first').focus();
          }
        }
      });
    }
  }).on('touchmove', function (e) {
    pathTouchMoved = true;
  }).on('touchstart', function () {
    pathTouchMoved = false;
  });
  /* Ajaxify form required the following properties:
           - attribute 'data-async' on form
           - div in the form with id 'formBody'
           - div above the form with id 'formMessage'
        */

  $('body').on('submit', 'form[data-async]', function (e) {
    e.preventDefault();
    var redirect = $('button[type=submit][clicked="true"]').attr('redirect');
    var formData = new FormData(this);
    formData.append('saveAndClose', redirect ? '1' : '0');
    $.ajax({
      processData: false,
      cache: false,
      contentType: false,
      type: $(this).attr('method'),
      url: $(this).attr('action'),
      data: formData
    }).done(function (data) {
      if (typeof data.redirectToRoute !== 'undefined') {
        window.location = data.redirectToRoute;
      }

      if (typeof data.message !== 'undefined') {
        $('#formMessage').html(data.message).fadeIn().removeClass('alert').addClass('success');
        setTimeout(function () {
          $("#formMessage").fadeOut('slow');
        }, 7000);
      }
    }).fail(function (jqXHR, textStatus, errorThrown) {
      if (typeof jqXHR.responseJSON !== 'undefined') {
        if (jqXHR.responseJSON.hasOwnProperty('form')) {
          $('#formBody').html(jqXHR.responseJSON.form);
        }

        $('#formMessage').html(jqXHR.responseJSON.message).fadeIn().removeClass('success').addClass('alert');
        setTimeout(function () {
          $("#formMessage").fadeOut('slow');
        }, 7000);
      } else {
        alert(errorThrown);
      }
    });
  });
  $('body').on('click', 'form[data-async] button[type=submit]', function () {
    $('button[type=submit]', $(this).parents('form[data-async]')).removeAttr('clicked');
    $(this).attr('clicked', true);
  });
});
console.log("formLoad loaded");

/***/ }),

/***/ 0:
/*!***************************************************!*\
  !*** multi ./app/Resources/assets/js/formLoad.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./app/Resources/assets/js/formLoad.js */"./app/Resources/assets/js/formLoad.js");


/***/ })

},[[0,"runtime"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvUmVzb3VyY2VzL2Fzc2V0cy9qcy9mb3JtTG9hZC5qcyJdLCJuYW1lcyI6WyJSZXZlYWwiLCJzaXplIiwib3JpZ2luIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJyZXZlYWxvYmplY3QiLCJpbm5lckhUTUwiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJldmVudExpc3RlbmVycyIsIiQiLCJvbiIsImV2ZW50IiwibGFyZ2UiLCJjbG9zZXN0IiwicmVtb3ZlIiwiY2hhbmdlRm9ybVJlc3VsdCIsInN1Ym1pdCIsImUiLCJmb3JtRWxtIiwicmV2ZWFsIiwiZ2V0IiwicHJldmVudERlZmF1bHQiLCJmb3JtVXJsIiwiYXR0ciIsImZvcm1EYXRhIiwic2VyaWFsaXplIiwiYWpheCIsInR5cGUiLCJ1cmwiLCJkYXRhIiwiYXN5bmMiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzZWxlY3RFbG0iLCJmaW5kIiwiZmlyc3QiLCJhcHBlbmQiLCJ2YWx1ZSIsImlkIiwidGV4dCIsIm5hbWUiLCJ2YWwiLCJmb3VuZGF0aW9uIiwiZXJyb3IiLCJYTUxIdHRwUmVxdWVzdCIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImV4IiwiYWxlcnQiLCJtZXNzYWdlIiwic2NvcGUiLCJkYXRlRm9ybWF0IiwiZGF0ZXBpY2tlclNldHRpbmdzIiwic2hvd1dlZWsiLCJudW1iZXJPZk1vbnRocyIsInByZXZUZXh0IiwibmV4dFRleHQiLCJ3ZWVrSGVhZGVyIiwiZmlyc3REYXkiLCJkYXlOYW1lcyIsImRheU5hbWVzTWluIiwibW9udGhOYW1lcyIsIm1vbnRoTmFtZXNTaG9ydCIsImJlZm9yZVNob3ciLCJpbnB1dCIsImluc3QiLCJhZGRDbGFzcyIsIndpbmRvdyIsInJlYWR5IiwicGF0aFRvdWNoTW92ZWQiLCJkaXNhYmxlZCIsInBhdGgiLCJlbGVtZW50VG9PcGVuIiwiaHRtbCIsInNlbGVjdDIiLCJmaWx0ZXIiLCJmb2N1cyIsInJlZGlyZWN0IiwiRm9ybURhdGEiLCJwcm9jZXNzRGF0YSIsImNhY2hlIiwiY29udGVudFR5cGUiLCJkb25lIiwicmVkaXJlY3RUb1JvdXRlIiwibG9jYXRpb24iLCJmYWRlSW4iLCJyZW1vdmVDbGFzcyIsInNldFRpbWVvdXQiLCJmYWRlT3V0IiwiZmFpbCIsImpxWEhSIiwicmVzcG9uc2VKU09OIiwiaGFzT3duUHJvcGVydHkiLCJmb3JtIiwicGFyZW50cyIsInJlbW92ZUF0dHIiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxTQUFTQSxNQUFULENBQWdCQyxJQUFoQixFQUFzQkMsTUFBdEIsRUFBOEI7QUFDMUIsTUFBSUMsRUFBRSxHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBVDtBQUNBRixJQUFFLENBQUNHLFNBQUgsR0FBZSxZQUFZTCxJQUEzQjtBQUNBRSxJQUFFLENBQUNJLFlBQUgsQ0FBZ0IsYUFBaEIsRUFBK0IsRUFBL0I7QUFDQUosSUFBRSxDQUFDSSxZQUFILENBQWdCLE1BQWhCLEVBQXdCLFFBQXhCO0FBQ0FKLElBQUUsQ0FBQ0ksWUFBSCxDQUFnQixjQUFoQixFQUFnQyxxQkFBaEM7QUFDQUosSUFBRSxDQUFDSyxZQUFILEdBQWtCLElBQWxCO0FBQ0FMLElBQUUsQ0FBQ00sU0FBSCxHQUFlLEVBQWY7QUFDQSxPQUFLUCxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxPQUFLQyxFQUFMLEdBQVVDLFFBQVEsQ0FBQ00sSUFBVCxDQUFjQyxXQUFkLENBQTBCUixFQUExQixDQUFWO0FBQ0FTLGdCQUFjLENBQUMsS0FBS1QsRUFBTixDQUFkO0FBQ0FVLEdBQUMsQ0FBQyxLQUFLVixFQUFOLENBQUQsQ0FBV1csRUFBWCxDQUFjLGtCQUFkLEVBQWtDLFVBQVNDLEtBQVQsRUFBZ0JDLEtBQWhCLEVBQXVCO0FBQ3JESCxLQUFDLENBQUMsSUFBRCxDQUFELENBQVFJLE9BQVIsQ0FBZ0Isb0JBQWhCLEVBQXNDQyxNQUF0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eEI7QUFDSCxHQUhEO0FBSUgsQ0ExR0w7QUE0R0l5RSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFIiwiZmlsZSI6ImZvcm1Mb2FkLjU0NGMyZTUwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gUmV2ZWFsKHNpemUsIG9yaWdpbikge1xuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsLmNsYXNzTmFtZSA9IFwicmV2ZWFsIFwiICsgc2l6ZTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXJldmVhbFwiLCBcIlwiKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiZGlhbG9nXCIpO1xuICAgIGVsLnNldEF0dHJpYnV0ZShcImRhdGEtb3B0aW9uc1wiLCBcImNsb3NlT25DbGljazpmYWxzZTtcIik7XG4gICAgZWwucmV2ZWFsb2JqZWN0ID0gdGhpcztcbiAgICBlbC5pbm5lckhUTUwgPSAnJztcbiAgICB0aGlzLm9yaWdpbiA9IG9yaWdpbjtcbiAgICB0aGlzLmVsID0gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7XG4gICAgZXZlbnRMaXN0ZW5lcnModGhpcy5lbCk7XG4gICAgJCh0aGlzLmVsKS5vbignY2xvc2VkLnpmLnJldmVhbCcsIGZ1bmN0aW9uKGV2ZW50LCBsYXJnZSkge1xuICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJ2Rpdi5yZXZlYWwtb3ZlcmxheScpLnJlbW92ZSgpO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICAkKHRoaXMuZWwpLm9uKCdjbG9zZW1lLnpmLnJldmVhbCcsIGZ1bmN0aW9uKGV2ZW50LCBsYXJnZSkge1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNoYW5nZUZvcm1SZXN1bHQoKSB7XG5cbiAgICAkKCdmb3JtW2Zvcm1yZXN1bHQ9XCJqc29uXCJdJykuc3VibWl0KGZ1bmN0aW9uKGUpIHtcblxuICAgICAgICB2YXIgZm9ybUVsbSA9ICQodGhpcyk7XG4gICAgICAgIHZhciByZXZlYWwgPSAkKHRoaXMpLmNsb3Nlc3QoJy5yZXZlYWwnKS5nZXQoMCkucmV2ZWFsb2JqZWN0O1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdHJ5IHtcblxuICAgICAgICAgICAgdmFyIGZvcm1VcmwgPSAkKGZvcm1FbG0pLmF0dHIoJ2FjdGlvbicpO1xuICAgICAgICAgICAgdmFyIGZvcm1EYXRhID0gJCh0aGlzKS5zZXJpYWxpemUoKTtcblxuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6IGZvcm1VcmwsXG4gICAgICAgICAgICAgICAgZGF0YTogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0RWxtID0gJChyZXZlYWwub3JpZ2luKS5jbG9zZXN0KCcuZm9ybS1jb2xsZWN0aW9uLWFkZCcpLmZpbmQoJ3NlbGVjdCcpLmZpcnN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEVsbS5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCc8b3B0aW9uPicsIHsgdmFsdWU6IHJlc3BvbnNlLmlkIH0pLnRleHQocmVzcG9uc2UubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0RWxtLnZhbChyZXNwb25zZS5pZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9ybUVsbS5jbG9zZXN0KCcucmV2ZWFsJykuZm91bmRhdGlvbignY2xvc2UnKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihYTUxIdHRwUmVxdWVzdCwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pXG4gICAgICAgICAgICAgICAge1xuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGV4KSB7XG4gICAgICAgICAgICBhbGVydChleC5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGV2ZW50TGlzdGVuZXJzKHNjb3BlKSB7XG4gICAgc2NvcGUgPSBzY29wZSB8fCBkb2N1bWVudDtcbiAgICB2YXIgZGF0ZUZvcm1hdCA9ICdkZC1tbS15eSc7XG4gICAgdmFyIGRhdGVwaWNrZXJTZXR0aW5ncyA9IHtcbiAgICAgICAgZGF0ZUZvcm1hdDogZGF0ZUZvcm1hdCxcblxuICAgICAgICBzaG93V2VlazogdHJ1ZSxcbiAgICAgICAgbnVtYmVyT2ZNb250aHM6IDEsXG4gICAgICAgIHByZXZUZXh0OiAnICcsXG4gICAgICAgIG5leHRUZXh0OiAnICcsXG4gICAgICAgIHdlZWtIZWFkZXI6ICcgJyxcbiAgICAgICAgZmlyc3REYXk6IDEsXG4gICAgICAgIGRheU5hbWVzOiBbICdab25kYWcnLCAnTWFuZGFhZycsICdEaW5zZGFnJywgJ1dvZW5zZGFnJywgJ0RvbmRlcmRhZycsICdWcmlqZGFnJywgJ1phdGVyZGFnJyBdLFxuICAgICAgICBkYXlOYW1lc01pbjogWyAnWm8nLCAnTWEnLCAnRGknLCAnV28nLCAnRG8nLCAnVnInLCAnWmEnIF0sXG4gICAgICAgIG1vbnRoTmFtZXM6IFsgJ0phbnVhcmknLCAnRmVicnVhcmknLCAnTWFhcnQnLCAnQXByaWwnLCAnTWVpJywgJ0p1bmknLCAnSnVsaScsICdBdWd1c3R1cycsICdTZXB0ZW1iZXInLCAnT2t0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlcicgXSxcbiAgICAgICAgbW9udGhOYW1lc1Nob3J0OiBbICdKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWFqJywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPa3QnLCAnTm92JywgJ0RlYycgXSxcbiAgICAgICAgYmVmb3JlU2hvdzogZnVuY3Rpb24oaW5wdXQsIGluc3QpIHtcbiAgICAgICAgICAgICQoJyN1aS1kYXRlcGlja2VyLWRpdicpLmFkZENsYXNzKCdzdGFuZGFsb25lLWRhdGVwaWNrZXInKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cblxud2luZG93LlJldmVhbCA9IFJldmVhbFxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xuXG4gICAgdmFyIHBhdGhUb3VjaE1vdmVkID0gZmFsc2U7XG4gICAgICAgICQoJ2JvZHknKS5vbignY2xpY2sgdG91Y2hlbmQnLCAnW2RhdGEtcGF0aF0nLCBmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgICAgIGlmIChwYXRoVG91Y2hNb3ZlZCAhPSB0cnVlKSB7XG5cbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICAkKHRoaXMpLmRpc2FibGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1wYXRoXCIpO1xuICAgICAgICAgICAgICAgIC8vaWYgKHBhdGhbMF0gIT09ICcvJylcbiAgICAgICAgICAgICAgICAvLyAgICBSb3V0aW5nLmdlbmVyYXRlKHBhdGgpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocGF0aCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9ICQodGhpcykuYXR0cihcImRhdGEtcmV2ZWFsLXNpemVcIik7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbiA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmV2ZWFsID0gbmV3IFJldmVhbChzaXplID8gc2l6ZSA6ICdsYXJnZScsIG9yaWdpbik7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRUb09wZW4gPSAkKHRoaXMpLmF0dHIoXCJkYXRhLW9wZW4tZWxlbWVudFwiKTtcblxuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHBhdGgsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJChyZXZlYWwuZWwpLmZvdW5kYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQocmV2ZWFsLmVsKS5odG1sKGRhdGEpLmZvdW5kYXRpb24oJ29wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJz4gZGl2JywgcmV2ZWFsLmVsKS5mb3VuZGF0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUZvcm1SZXN1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50VG9PcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50VG9PcGVuKS5zZWxlY3QyKCdvcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmb2N1cyBmaXJzdCB2aXNpYmxlIGZpZWxkIGluIGZvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCdmb3JtJykuZmluZCgnKicpLmZpbHRlcignOmlucHV0OnZpc2libGU6Zmlyc3QnKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLm9uKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihlKXtcbiAgICAgICAgICAgIHBhdGhUb3VjaE1vdmVkID0gdHJ1ZTtcbiAgICAgICAgfSkub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcGF0aFRvdWNoTW92ZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbiAgIC8qIEFqYXhpZnkgZm9ybSByZXF1aXJlZCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG4gICAgICAgICAgICAtIGF0dHJpYnV0ZSAnZGF0YS1hc3luYycgb24gZm9ybVxuICAgICAgICAgICAgLSBkaXYgaW4gdGhlIGZvcm0gd2l0aCBpZCAnZm9ybUJvZHknXG4gICAgICAgICAgICAtIGRpdiBhYm92ZSB0aGUgZm9ybSB3aXRoIGlkICdmb3JtTWVzc2FnZSdcbiAgICAgICAgICovXG4gICAgICAgICQoJ2JvZHknKS5vbignc3VibWl0JywgJ2Zvcm1bZGF0YS1hc3luY10nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICB2YXIgcmVkaXJlY3QgPSAkKCdidXR0b25bdHlwZT1zdWJtaXRdW2NsaWNrZWQ9XCJ0cnVlXCJdJykuYXR0cigncmVkaXJlY3QnKTtcbiAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSh0aGlzKTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnc2F2ZUFuZENsb3NlJywgKHJlZGlyZWN0ID8gJzEnIDogJzAnKSk7XG5cbiAgICAgICAgICAgICQuYWpheCh7XG5cbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0eXBlOiAkKHRoaXMpLmF0dHIoJ21ldGhvZCcpLFxuICAgICAgICAgICAgICAgIHVybDogJCh0aGlzKS5hdHRyKCdhY3Rpb24nKSxcbiAgICAgICAgICAgICAgICBkYXRhOiBmb3JtRGF0YVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5yZWRpcmVjdFRvUm91dGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGRhdGEucmVkaXJlY3RUb1JvdXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEubWVzc2FnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnI2Zvcm1NZXNzYWdlJykuaHRtbChkYXRhLm1lc3NhZ2UpLmZhZGVJbigpLnJlbW92ZUNsYXNzKCdhbGVydCcpLmFkZENsYXNzKCdzdWNjZXNzJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjZm9ybU1lc3NhZ2VcIikuZmFkZU91dCgnc2xvdycpXG4gICAgICAgICAgICAgICAgICAgIH0sIDcwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YganFYSFIucmVzcG9uc2VKU09OICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoanFYSFIucmVzcG9uc2VKU09OLmhhc093blByb3BlcnR5KCdmb3JtJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNmb3JtQm9keScpLmh0bWwoanFYSFIucmVzcG9uc2VKU09OLmZvcm0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICQoJyNmb3JtTWVzc2FnZScpLmh0bWwoanFYSFIucmVzcG9uc2VKU09OLm1lc3NhZ2UpLmZhZGVJbigpLnJlbW92ZUNsYXNzKCdzdWNjZXNzJykuYWRkQ2xhc3MoJ2FsZXJ0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjZm9ybU1lc3NhZ2VcIikuZmFkZU91dCgnc2xvdycpXG4gICAgICAgICAgICAgICAgICAgIH0sIDcwMDApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoZXJyb3JUaHJvd24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NsaWNrJywgJ2Zvcm1bZGF0YS1hc3luY10gYnV0dG9uW3R5cGU9c3VibWl0XScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJCgnYnV0dG9uW3R5cGU9c3VibWl0XScsICQodGhpcykucGFyZW50cygnZm9ybVtkYXRhLWFzeW5jXScpKS5yZW1vdmVBdHRyKCdjbGlja2VkJyk7XG4gICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ2NsaWNrZWQnLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coXCJmb3JtTG9hZCBsb2FkZWRcIik7Il0sInNvdXJjZVJvb3QiOiIifQ==