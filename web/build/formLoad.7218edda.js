(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["formLoad"],{

/***/ "./app/Resources/assets/js/formLoad.js":
/*!*********************************************!*\
  !*** ./app/Resources/assets/js/formLoad.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function Reveal(size, origin) {
  var el = document.createElement('div');
  el.className = "reveal " + size;
  el.setAttribute("data-reveal", "");
  el.setAttribute("role", "dialog");
  el.setAttribute("data-options", "closeOnClick:false;");
  el.revealobject = this;
  el.innerHTML = '';
  this.origin = origin;
  this.el = document.body.appendChild(el);
  eventListeners(this.el);
  $(this.el).on('closed.zf.reveal', function (event, large) {
    $(this).closest('div.reveal-overlay').remove();
    return false;
  });
  $(this.el).on('closeme.zf.reveal', function (event, large) {
    return false;
  });
}

function changeFormResult() {
  $('form[formresult="json"]').submit(function (e) {
    var formElm = $(this);
    var reveal = $(this).closest('.reveal').get(0).revealobject;
    e.preventDefault();

    try {
      var formUrl = $(formElm).attr('action');
      var formData = $(this).serialize();
      $.ajax({
        type: "POST",
        url: formUrl,
        data: formData,
        async: true,
        success: function success(response) {
          var selectElm = $(reveal.origin).closest('.form-collection-add').find('select').first();
          selectElm.append($('<option>', {
            value: response.id
          }).text(response.name));
          selectElm.val(response.id);
          formElm.closest('.reveal').foundation('close');
        },
        error: function error(XMLHttpRequest, textStatus, errorThrown) {}
      });
    } catch (ex) {
      alert(ex.message);
    }

    return false;
  });
}

function eventListeners(scope) {
  scope = scope || document;
  var dateFormat = 'dd-mm-yy';
  var datepickerSettings = {
    dateFormat: dateFormat,
    showWeek: true,
    numberOfMonths: 1,
    prevText: ' ',
    nextText: ' ',
    weekHeader: ' ',
    firstDay: 1,
    dayNames: ['Zondag', 'Mandaag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrijdag', 'Zaterdag'],
    dayNamesMin: ['Zo', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Za'],
    monthNames: ['Januari', 'Februari', 'Maart', 'April', 'Mei', 'Juni', 'Juli', 'Augustus', 'September', 'Oktober', 'November', 'December'],
    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],
    beforeShow: function beforeShow(input, inst) {
      $('#ui-datepicker-div').addClass('standalone-datepicker');
    }
  };
}

window.Reveal = Reveal;
$(document).ready(function () {
  var pathTouchMoved = false;
  $('body').on('click touchend', '[data-path]', function (e) {
    if (pathTouchMoved != true) {
      e.preventDefault();
      $(this).disabled = true;
      var path = $(this).attr("data-path"); //if (path[0] !== '/')
      //    Routing.generate(path);
      //console.log(path);

      var size = $(this).attr("data-reveal-size");
      var origin = this;
      var reveal = new Reveal(size ? size : 'large', origin);
      var elementToOpen = $(this).attr("data-open-element");
      $.ajax({
        type: 'GET',
        url: path,
        success: function success(data) {
          $(reveal.el).foundation();
          $(reveal.el).html(data).foundation('open');
          $('> div', reveal.el).foundation();
          changeFormResult();
          eventListeners();

          if (elementToOpen) {
            $(elementToOpen).select2('open');
          } else {
            // focus first visible field in form
            $('form').find('*').filter(':input:visible:first').focus();
          }
        }
      });
    }
  }).on('touchmove', function (e) {
    pathTouchMoved = true;
  }).on('touchstart', function () {
    pathTouchMoved = false;
  });
});
/* Ajaxify form required the following properties:
         - attribute 'data-async' on form
         - div in the form with id 'formBody'
         - div above the form with id 'formMessage'
      */

$('body').on('submit', 'form[data-async]', function (e) {
  e.preventDefault();
  var redirect = $('button[type=submit][clicked="true"]').attr('redirect');
  var formData = new FormData(this);
  formData.append('saveAndClose', redirect ? '1' : '0');
  $.ajax({
    processData: false,
    cache: false,
    contentType: false,
    type: $(this).attr('method'),
    url: $(this).attr('action'),
    data: formData
  }).done(function (data) {
    if (typeof data.redirectToRoute !== 'undefined') {
      window.location = data.redirectToRoute;
    }

    if (typeof data.message !== 'undefined') {
      $('#formMessage').html(data.message).fadeIn().removeClass('alert').addClass('success');
      setTimeout(function () {
        $("#formMessage").fadeOut('slow');
      }, 7000);
    }
  }).fail(function (jqXHR, textStatus, errorThrown) {
    if (typeof jqXHR.responseJSON !== 'undefined') {
      if (jqXHR.responseJSON.hasOwnProperty('form')) {
        $('#formBody').html(jqXHR.responseJSON.form);
      }

      $('#formMessage').html(jqXHR.responseJSON.message).fadeIn().removeClass('success').addClass('alert');
      setTimeout(function () {
        $("#formMessage").fadeOut('slow');
      }, 7000);
    } else {
      alert(errorThrown);
    }
  });
});
$('body').on('click', 'form[data-async] button[type=submit]', function () {
  $('button[type=submit]', $(this).parents('form[data-async]')).removeAttr('clicked');
  $(this).attr('clicked', true);
});
console.log("formLoad loaded");

/***/ }),

/***/ 0:
/*!***************************************************!*\
  !*** multi ./app/Resources/assets/js/formLoad.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./app/Resources/assets/js/formLoad.js */"./app/Resources/assets/js/formLoad.js");


/***/ })

},[[0,"runtime"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvUmVzb3VyY2VzL2Fzc2V0cy9qcy9mb3JtTG9hZC5qcyJdLCJuYW1lcyI6WyJSZXZlYWwiLCJzaXplIiwib3JpZ2luIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJyZXZlYWxvYmplY3QiLCJpbm5lckhUTUwiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJldmVudExpc3RlbmVycyIsIiQiLCJvbiIsImV2ZW50IiwibGFyZ2UiLCJjbG9zZXN0IiwicmVtb3ZlIiwiY2hhbmdlRm9ybVJlc3VsdCIsInN1Ym1pdCIsImUiLCJmb3JtRWxtIiwicmV2ZWFsIiwiZ2V0IiwicHJldmVudERlZmF1bHQiLCJmb3JtVXJsIiwiYXR0ciIsImZvcm1EYXRhIiwic2VyaWFsaXplIiwiYWpheCIsInR5cGUiLCJ1cmwiLCJkYXRhIiwiYXN5bmMiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzZWxlY3RFbG0iLCJmaW5kIiwiZmlyc3QiLCJhcHBlbmQiLCJ2YWx1ZSIsImlkIiwidGV4dCIsIm5hbWUiLCJ2YWwiLCJmb3VuZGF0aW9uIiwiZXJyb3IiLCJYTUxIdHRwUmVxdWVzdCIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImV4IiwiYWxlcnQiLCJtZXNzYWdlIiwic2NvcGUiLCJkYXRlRm9ybWF0IiwiZGF0ZXBpY2tlclNldHRpbmdzIiwic2hvd1dlZWsiLCJudW1iZXJPZk1vbnRocyIsInByZXZUZXh0IiwibmV4dFRleHQiLCJ3ZWVrSGVhZGVyIiwiZmlyc3REYXkiLCJkYXlOYW1lcyIsImRheU5hbWVzTWluIiwibW9udGhOYW1lcyIsIm1vbnRoTmFtZXNTaG9ydCIsImJlZm9yZVNob3ciLCJpbnB1dCIsImluc3QiLCJhZGRDbGFzcyIsIndpbmRvdyIsInJlYWR5IiwicGF0aFRvdWNoTW92ZWQiLCJkaXNhYmxlZCIsInBhdGgiLCJlbGVtZW50VG9PcGVuIiwiaHRtbCIsInNlbGVjdDIiLCJmaWx0ZXIiLCJmb2N1cyIsInJlZGlyZWN0IiwiRm9ybURhdGEiLCJwcm9jZXNzRGF0YSIsImNhY2hlIiwiY29udGVudFR5cGUiLCJkb25lIiwicmVkaXJlY3RUb1JvdXRlIiwibG9jYXRpb24iLCJmYWRlSW4iLCJyZW1vdmVDbGFzcyIsInNldFRpbWVvdXQiLCJmYWRlT3V0IiwiZmFpbCIsImpxWEhSIiwicmVzcG9uc2VKU09OIiwiaGFzT3duUHJvcGVydHkiLCJmb3JtIiwicGFyZW50cyIsInJlbW92ZUF0dHIiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxTQUFTQSxNQUFULENBQWdCQyxJQUFoQixFQUFzQkMsTUFBdEIsRUFBOEI7QUFDMUIsTUFBSUMsRUFBRSxHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBVDtBQUNBRixJQUFFLENBQUNHLFNBQUgsR0FBZSxZQUFZTCxJQUEzQjtBQUNBRSxJQUFFLENBQUNJLFlBQUgsQ0FBZ0IsYUFBaEIsRUFBK0IsRUFBL0I7QUFDQUosSUFBRSxDQUFDSSxZQUFILENBQWdCLE1BQWhCLEVBQXdCLFFBQXhCO0FBQ0FKLElBQUUsQ0FBQ0ksWUFBSCxDQUFnQixjQUFoQixFQUFnQyxxQkFBaEM7QUFDQUosSUFBRSxDQUFDSyxZQUFILEdBQWtCLElBQWxCO0FBQ0FMLElBQUUsQ0FBQ00sU0FBSCxHQUFlLEVBQWY7QUFDQSxPQUFLUCxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxPQUFLQyxFQUFMLEdBQVVDLFFBQVEsQ0FBQ00sSUFBVCxDQUFjQyxXQUFkLENBQTBCUixFQUExQixDQUFWO0FBQ0FTLGdCQUFjLENBQUMsS0FBS1QsRUFBTixDQUFkO0FBQ0FVLEdBQUMsQ0FBQyxLQUFLVixFQUFOLENBQUQsQ0FBV1csRUFBWCxDQUFjLGtCQUFkLEVBQWtDLFVBQVNDLEtBQVQsRUFBZ0JDLEtBQWhCLEVBQXVCO0FBQ3JESCxLQUFDLENBQUMsSUFBRCxDQUFELENBQVFJLE9BQVIsQ0FBZ0Isb0JBQWhCLEVBQXNDQyxNQUF0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LEVBQXdCLElBQXhCO0FBQ0gsQ0FIRDtBQUtKeUUsT0FBTyxDQUFDQyxHQUFSLENBQVksaUJBQVosRSIsImZpbGUiOiJmb3JtTG9hZC43MjE4ZWRkYS5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIFJldmVhbChzaXplLCBvcmlnaW4pIHtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbC5jbGFzc05hbWUgPSBcInJldmVhbCBcIiArIHNpemU7XG4gICAgZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1yZXZlYWxcIiwgXCJcIik7XG4gICAgZWwuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImRpYWxvZ1wiKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLW9wdGlvbnNcIiwgXCJjbG9zZU9uQ2xpY2s6ZmFsc2U7XCIpO1xuICAgIGVsLnJldmVhbG9iamVjdCA9IHRoaXM7XG4gICAgZWwuaW5uZXJIVE1MID0gJyc7XG4gICAgdGhpcy5vcmlnaW4gPSBvcmlnaW47XG4gICAgdGhpcy5lbCA9IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xuICAgIGV2ZW50TGlzdGVuZXJzKHRoaXMuZWwpO1xuICAgICQodGhpcy5lbCkub24oJ2Nsb3NlZC56Zi5yZXZlYWwnLCBmdW5jdGlvbihldmVudCwgbGFyZ2UpIHtcbiAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCdkaXYucmV2ZWFsLW92ZXJsYXknKS5yZW1vdmUoKTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgJCh0aGlzLmVsKS5vbignY2xvc2VtZS56Zi5yZXZlYWwnLCBmdW5jdGlvbihldmVudCwgbGFyZ2UpIHtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBjaGFuZ2VGb3JtUmVzdWx0KCkge1xuXG4gICAgJCgnZm9ybVtmb3JtcmVzdWx0PVwianNvblwiXScpLnN1Ym1pdChmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgdmFyIGZvcm1FbG0gPSAkKHRoaXMpO1xuICAgICAgICB2YXIgcmV2ZWFsID0gJCh0aGlzKS5jbG9zZXN0KCcucmV2ZWFsJykuZ2V0KDApLnJldmVhbG9iamVjdDtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBmb3JtVXJsID0gJChmb3JtRWxtKS5hdHRyKCdhY3Rpb24nKTtcbiAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9ICQodGhpcykuc2VyaWFsaXplKCk7XG5cbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgdXJsOiBmb3JtVXJsLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdEVsbSA9ICQocmV2ZWFsLm9yaWdpbikuY2xvc2VzdCgnLmZvcm0tY29sbGVjdGlvbi1hZGQnKS5maW5kKCdzZWxlY3QnKS5maXJzdCgpO1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RFbG0uYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnPG9wdGlvbj4nLCB7IHZhbHVlOiByZXNwb25zZS5pZCB9KS50ZXh0KHJlc3BvbnNlLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEVsbS52YWwocmVzcG9uc2UuaWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvcm1FbG0uY2xvc2VzdCgnLnJldmVhbCcpLmZvdW5kYXRpb24oJ2Nsb3NlJyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oWE1MSHR0cFJlcXVlc3QsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKVxuICAgICAgICAgICAgICAgIHtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaChleCkge1xuICAgICAgICAgICAgYWxlcnQoZXgubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBldmVudExpc3RlbmVycyhzY29wZSkge1xuICAgIHNjb3BlID0gc2NvcGUgfHwgZG9jdW1lbnQ7XG4gICAgdmFyIGRhdGVGb3JtYXQgPSAnZGQtbW0teXknO1xuICAgIHZhciBkYXRlcGlja2VyU2V0dGluZ3MgPSB7XG4gICAgICAgIGRhdGVGb3JtYXQ6IGRhdGVGb3JtYXQsXG5cbiAgICAgICAgc2hvd1dlZWs6IHRydWUsXG4gICAgICAgIG51bWJlck9mTW9udGhzOiAxLFxuICAgICAgICBwcmV2VGV4dDogJyAnLFxuICAgICAgICBuZXh0VGV4dDogJyAnLFxuICAgICAgICB3ZWVrSGVhZGVyOiAnICcsXG4gICAgICAgIGZpcnN0RGF5OiAxLFxuICAgICAgICBkYXlOYW1lczogWyAnWm9uZGFnJywgJ01hbmRhYWcnLCAnRGluc2RhZycsICdXb2Vuc2RhZycsICdEb25kZXJkYWcnLCAnVnJpamRhZycsICdaYXRlcmRhZycgXSxcbiAgICAgICAgZGF5TmFtZXNNaW46IFsgJ1pvJywgJ01hJywgJ0RpJywgJ1dvJywgJ0RvJywgJ1ZyJywgJ1phJyBdLFxuICAgICAgICBtb250aE5hbWVzOiBbICdKYW51YXJpJywgJ0ZlYnJ1YXJpJywgJ01hYXJ0JywgJ0FwcmlsJywgJ01laScsICdKdW5pJywgJ0p1bGknLCAnQXVndXN0dXMnLCAnU2VwdGVtYmVyJywgJ09rdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInIF0sXG4gICAgICAgIG1vbnRoTmFtZXNTaG9ydDogWyAnSmFuJywgJ0ZlYicsICdNYXInLCAnQXByJywgJ01haicsICdKdW4nLCAnSnVsJywgJ0F1ZycsICdTZXAnLCAnT2t0JywgJ05vdicsICdEZWMnIF0sXG4gICAgICAgIGJlZm9yZVNob3c6IGZ1bmN0aW9uKGlucHV0LCBpbnN0KSB7XG4gICAgICAgICAgICAkKCcjdWktZGF0ZXBpY2tlci1kaXYnKS5hZGRDbGFzcygnc3RhbmRhbG9uZS1kYXRlcGlja2VyJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5cbndpbmRvdy5SZXZlYWwgPSBSZXZlYWxcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcblxuICAgIHZhciBwYXRoVG91Y2hNb3ZlZCA9IGZhbHNlO1xuICAgICAgICAkKCdib2R5Jykub24oJ2NsaWNrIHRvdWNoZW5kJywgJ1tkYXRhLXBhdGhdJywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICBpZiAocGF0aFRvdWNoTW92ZWQgIT0gdHJ1ZSkge1xuXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5kaXNhYmxlZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICQodGhpcykuYXR0cihcImRhdGEtcGF0aFwiKTtcbiAgICAgICAgICAgICAgICAvL2lmIChwYXRoWzBdICE9PSAnLycpXG4gICAgICAgICAgICAgICAgLy8gICAgUm91dGluZy5nZW5lcmF0ZShwYXRoKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLXJldmVhbC1zaXplXCIpO1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW4gPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJldmVhbCA9IG5ldyBSZXZlYWwoc2l6ZSA/IHNpemUgOiAnbGFyZ2UnLCBvcmlnaW4pO1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50VG9PcGVuID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1vcGVuLWVsZW1lbnRcIik7XG5cbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBwYXRoLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICQocmV2ZWFsLmVsKS5mb3VuZGF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHJldmVhbC5lbCkuaHRtbChkYXRhKS5mb3VuZGF0aW9uKCdvcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCc+IGRpdicsIHJldmVhbC5lbCkuZm91bmRhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VGb3JtUmVzdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudExpc3RlbmVycygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudFRvT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZWxlbWVudFRvT3Blbikuc2VsZWN0Mignb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9jdXMgZmlyc3QgdmlzaWJsZSBmaWVsZCBpbiBmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnZm9ybScpLmZpbmQoJyonKS5maWx0ZXIoJzppbnB1dDp2aXNpYmxlOmZpcnN0JykuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5vbigndG91Y2htb3ZlJywgZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICBwYXRoVG91Y2hNb3ZlZCA9IHRydWU7XG4gICAgICAgIH0pLm9uKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHBhdGhUb3VjaE1vdmVkID0gZmFsc2U7XG4gICAgICAgIH0pO1xuXG59KTtcblxuICAgLyogQWpheGlmeSBmb3JtIHJlcXVpcmVkIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICAgICAgICAgIC0gYXR0cmlidXRlICdkYXRhLWFzeW5jJyBvbiBmb3JtXG4gICAgICAgICAgICAtIGRpdiBpbiB0aGUgZm9ybSB3aXRoIGlkICdmb3JtQm9keSdcbiAgICAgICAgICAgIC0gZGl2IGFib3ZlIHRoZSBmb3JtIHdpdGggaWQgJ2Zvcm1NZXNzYWdlJ1xuICAgICAgICAgKi9cbiAgICAgICAgJCgnYm9keScpLm9uKCdzdWJtaXQnLCAnZm9ybVtkYXRhLWFzeW5jXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIHZhciByZWRpcmVjdCA9ICQoJ2J1dHRvblt0eXBlPXN1Ym1pdF1bY2xpY2tlZD1cInRydWVcIl0nKS5hdHRyKCdyZWRpcmVjdCcpO1xuICAgICAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKHRoaXMpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdzYXZlQW5kQ2xvc2UnLCAocmVkaXJlY3QgPyAnMScgOiAnMCcpKTtcblxuICAgICAgICAgICAgJC5hamF4KHtcblxuICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHR5cGU6ICQodGhpcykuYXR0cignbWV0aG9kJyksXG4gICAgICAgICAgICAgICAgdXJsOiAkKHRoaXMpLmF0dHIoJ2FjdGlvbicpLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhLnJlZGlyZWN0VG9Sb3V0ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gZGF0YS5yZWRpcmVjdFRvUm91dGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5tZXNzYWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAkKCcjZm9ybU1lc3NhZ2UnKS5odG1sKGRhdGEubWVzc2FnZSkuZmFkZUluKCkucmVtb3ZlQ2xhc3MoJ2FsZXJ0JykuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNmb3JtTWVzc2FnZVwiKS5mYWRlT3V0KCdzbG93JylcbiAgICAgICAgICAgICAgICAgICAgfSwgNzAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBqcVhIUi5yZXNwb25zZUpTT04gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChqcVhIUi5yZXNwb25zZUpTT04uaGFzT3duUHJvcGVydHkoJ2Zvcm0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2Zvcm1Cb2R5JykuaHRtbChqcVhIUi5yZXNwb25zZUpTT04uZm9ybSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJCgnI2Zvcm1NZXNzYWdlJykuaHRtbChqcVhIUi5yZXNwb25zZUpTT04ubWVzc2FnZSkuZmFkZUluKCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKS5hZGRDbGFzcygnYWxlcnQnKTtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNmb3JtTWVzc2FnZVwiKS5mYWRlT3V0KCdzbG93JylcbiAgICAgICAgICAgICAgICAgICAgfSwgNzAwMCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChlcnJvclRocm93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnZm9ybVtkYXRhLWFzeW5jXSBidXR0b25bdHlwZT1zdWJtaXRdJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKCdidXR0b25bdHlwZT1zdWJtaXRdJywgJCh0aGlzKS5wYXJlbnRzKCdmb3JtW2RhdGEtYXN5bmNdJykpLnJlbW92ZUF0dHIoJ2NsaWNrZWQnKTtcbiAgICAgICAgICAgICQodGhpcykuYXR0cignY2xpY2tlZCcsIHRydWUpO1xuICAgICAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwiZm9ybUxvYWQgbG9hZGVkXCIpOyJdLCJzb3VyY2VSb290IjoiIn0=