(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["formLoad"],{

/***/ "./app/Resources/assets/js/formLoad.js":
/*!*********************************************!*\
  !*** ./app/Resources/assets/js/formLoad.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function Reveal(size, origin) {
  var el = document.createElement('div');
  el.className = "reveal " + size;
  el.setAttribute("data-reveal", "");
  el.setAttribute("role", "dialog");
  el.setAttribute("data-options", "closeOnClick:false;");
  el.revealobject = this;
  el.innerHTML = '';
  this.origin = origin;
  this.el = document.body.appendChild(el);
  eventListeners(this.el);
  $(this.el).on('closed.zf.reveal', function (event, large) {
    $(this).closest('div.reveal-overlay').remove();
    return false;
  });
  $(this.el).on('closeme.zf.reveal', function (event, large) {
    return false;
  });
}

function changeFormResult() {
  $('form[formresult="json"]').submit(function (e) {
    var formElm = $(this);
    var reveal = $(this).closest('.reveal').get(0).revealobject;
    e.preventDefault();

    try {
      var formUrl = $(formElm).attr('action');
      var formData = $(this).serialize();
      $.ajax({
        type: "POST",
        url: formUrl,
        data: formData,
        async: true,
        success: function success(response) {
          var selectElm = $(reveal.origin).closest('.form-collection-add').find('select').first();
          selectElm.append($('<option>', {
            value: response.id
          }).text(response.name));
          selectElm.val(response.id);
          formElm.closest('.reveal').foundation('close');
        },
        error: function error(XMLHttpRequest, textStatus, errorThrown) {}
      });
    } catch (ex) {
      alert(ex.message);
    }

    return false;
  });
}

function eventListeners(scope) {
  scope = scope || document;
  var dateFormat = 'dd-mm-yy';
  var datepickerSettings = {
    dateFormat: dateFormat,
    showWeek: true,
    numberOfMonths: 1,
    prevText: ' ',
    nextText: ' ',
    weekHeader: ' ',
    firstDay: 1,
    dayNames: ['Zondag', 'Mandaag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrijdag', 'Zaterdag'],
    dayNamesMin: ['Zo', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Za'],
    monthNames: ['Januari', 'Februari', 'Maart', 'April', 'Mei', 'Juni', 'Juli', 'Augustus', 'September', 'Oktober', 'November', 'December'],
    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],
    beforeShow: function beforeShow(input, inst) {
      $('#ui-datepicker-div').addClass('standalone-datepicker');
    }
  };
}

window.Reveal = Reveal;
$(document).ready(function () {
  var pathTouchMoved = false;
  $('body').on('click touchend', '[data-path]', function (e) {
    if (pathTouchMoved != true) {
      e.preventDefault();
      $(this).disabled = true;
      var path = $(this).attr("data-path"); //if (path[0] !== '/')
      //    Routing.generate(path);
      //console.log(path);

      var size = $(this).attr("data-reveal-size");
      var origin = this;
      var reveal = new Reveal(size ? size : 'large', origin);
      var elementToOpen = $(this).attr("data-open-element");
      $.ajax({
        type: 'GET',
        url: path,
        success: function success(data) {
          $(reveal.el).foundation();
          $(reveal.el).html(data).foundation('open');
          $('> div', reveal.el).foundation();
          changeFormResult();
          eventListeners();

          if (elementToOpen) {
            $(elementToOpen).select2('open');
          } else {
            // focus first visible field in form
            $('form').find('*').filter(':input:visible:first').focus();
          }
        }
      });
    }
  }).on('touchmove', function (e) {
    pathTouchMoved = true;
  }).on('touchstart', function () {
    pathTouchMoved = false;
  });
  /* Ajaxify form required the following properties:
           - attribute 'data-async' on form
           - div in the form with id 'formBody'
           - div above the form with id 'formMessage'
        */

  $('body').on('submit', 'form[data-async]', function (e) {
    e.preventDefault();
    console.log("werkt");
    var redirect = $('button[type=submit][clicked="true"]').attr('redirect');
    var formData = new FormData(this);
    formData.append('saveAndClose', redirect ? '1' : '0');
    $.ajax({
      processData: false,
      cache: false,
      contentType: false,
      type: $(this).attr('method'),
      url: $(this).attr('action'),
      data: formData
    }).done(function (data) {
      if (typeof data.redirectToRoute !== 'undefined') {
        window.location = data.redirectToRoute;
      }

      if (typeof data.message !== 'undefined') {
        $('#formMessage').html(data.message).fadeIn().removeClass('alert').addClass('success');
        setTimeout(function () {
          $("#formMessage").fadeOut('slow');
        }, 7000);
      }
    }).fail(function (jqXHR, textStatus, errorThrown) {
      if (typeof jqXHR.responseJSON !== 'undefined') {
        if (jqXHR.responseJSON.hasOwnProperty('form')) {
          $('#formBody').html(jqXHR.responseJSON.form);
        }

        $('#formMessage').html(jqXHR.responseJSON.message).fadeIn().removeClass('success').addClass('alert');
        setTimeout(function () {
          $("#formMessage").fadeOut('slow');
        }, 5000);
      } else {
        alert(errorThrown);
      }
    });
  });
  $('body').on('click', 'form[data-async] button[type=submit]', function () {
    $('button[type=submit]', $(this).parents('form[data-async]')).removeAttr('clicked');
    $(this).attr('clicked', true);
  });
});
console.log("formLoad loaded");

/***/ }),

/***/ 0:
/*!***************************************************!*\
  !*** multi ./app/Resources/assets/js/formLoad.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./app/Resources/assets/js/formLoad.js */"./app/Resources/assets/js/formLoad.js");


/***/ })

},[[0,"runtime"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvUmVzb3VyY2VzL2Fzc2V0cy9qcy9mb3JtTG9hZC5qcyJdLCJuYW1lcyI6WyJSZXZlYWwiLCJzaXplIiwib3JpZ2luIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJyZXZlYWxvYmplY3QiLCJpbm5lckhUTUwiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJldmVudExpc3RlbmVycyIsIiQiLCJvbiIsImV2ZW50IiwibGFyZ2UiLCJjbG9zZXN0IiwicmVtb3ZlIiwiY2hhbmdlRm9ybVJlc3VsdCIsInN1Ym1pdCIsImUiLCJmb3JtRWxtIiwicmV2ZWFsIiwiZ2V0IiwicHJldmVudERlZmF1bHQiLCJmb3JtVXJsIiwiYXR0ciIsImZvcm1EYXRhIiwic2VyaWFsaXplIiwiYWpheCIsInR5cGUiLCJ1cmwiLCJkYXRhIiwiYXN5bmMiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJzZWxlY3RFbG0iLCJmaW5kIiwiZmlyc3QiLCJhcHBlbmQiLCJ2YWx1ZSIsImlkIiwidGV4dCIsIm5hbWUiLCJ2YWwiLCJmb3VuZGF0aW9uIiwiZXJyb3IiLCJYTUxIdHRwUmVxdWVzdCIsInRleHRTdGF0dXMiLCJlcnJvclRocm93biIsImV4IiwiYWxlcnQiLCJtZXNzYWdlIiwic2NvcGUiLCJkYXRlRm9ybWF0IiwiZGF0ZXBpY2tlclNldHRpbmdzIiwic2hvd1dlZWsiLCJudW1iZXJPZk1vbnRocyIsInByZXZUZXh0IiwibmV4dFRleHQiLCJ3ZWVrSGVhZGVyIiwiZmlyc3REYXkiLCJkYXlOYW1lcyIsImRheU5hbWVzTWluIiwibW9udGhOYW1lcyIsIm1vbnRoTmFtZXNTaG9ydCIsImJlZm9yZVNob3ciLCJpbnB1dCIsImluc3QiLCJhZGRDbGFzcyIsIndpbmRvdyIsInJlYWR5IiwicGF0aFRvdWNoTW92ZWQiLCJkaXNhYmxlZCIsInBhdGgiLCJlbGVtZW50VG9PcGVuIiwiaHRtbCIsInNlbGVjdDIiLCJmaWx0ZXIiLCJmb2N1cyIsImNvbnNvbGUiLCJsb2ciLCJyZWRpcmVjdCIsIkZvcm1EYXRhIiwicHJvY2Vzc0RhdGEiLCJjYWNoZSIsImNvbnRlbnRUeXBlIiwiZG9uZSIsInJlZGlyZWN0VG9Sb3V0ZSIsImxvY2F0aW9uIiwiZmFkZUluIiwicmVtb3ZlQ2xhc3MiLCJzZXRUaW1lb3V0IiwiZmFkZU91dCIsImZhaWwiLCJqcVhIUiIsInJlc3BvbnNlSlNPTiIsImhhc093blByb3BlcnR5IiwiZm9ybSIsInBhcmVudHMiLCJyZW1vdmVBdHRyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxTQUFTQSxNQUFULENBQWdCQyxJQUFoQixFQUFzQkMsTUFBdEIsRUFBOEI7QUFDMUIsTUFBSUMsRUFBRSxHQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBVDtBQUNBRixJQUFFLENBQUNHLFNBQUgsR0FBZSxZQUFZTCxJQUEzQjtBQUNBRSxJQUFFLENBQUNJLFlBQUgsQ0FBZ0IsYUFBaEIsRUFBK0IsRUFBL0I7QUFDQUosSUFBRSxDQUFDSSxZQUFILENBQWdCLE1BQWhCLEVBQXdCLFFBQXhCO0FBQ0FKLElBQUUsQ0FBQ0ksWUFBSCxDQUFnQixjQUFoQixFQUFnQyxxQkFBaEM7QUFDQUosSUFBRSxDQUFDSyxZQUFILEdBQWtCLElBQWxCO0FBQ0FMLElBQUUsQ0FBQ00sU0FBSCxHQUFlLEVBQWY7QUFDQSxPQUFLUCxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxPQUFLQyxFQUFMLEdBQVVDLFFBQVEsQ0FBQ00sSUFBVCxDQUFjQyxXQUFkLENBQTBCUixFQUExQixDQUFWO0FBQ0FTLGdCQUFjLENBQUMsS0FBS1QsRUFBTixDQUFkO0FBQ0FVLEdBQUMsQ0FBQyxLQUFLVixFQUFOLENBQUQsQ0FBV1csRUFBWCxDQUFjLGtCQUFkLEVBQWtDLFVBQVNDLEtBQVQsRUFBZ0JDLEtBQWhCLEVBQXVCO0FBQ3JESCxLQUFDLENBQUMsSUFBRCxDQUFELENBQVFJLE9BQVIsQ0FBZ0Isb0JBQWhCLEVBQXNDQyxNQUF0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RCxDQUFRYyxJQUFSLENBQWEsU0FBYixFQUF3QixJQUF4QjtBQUNILEdBSEQ7QUFJSCxDQTVHTDtBQThHSXNELE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGlCQUFaLEUiLCJmaWxlIjoiZm9ybUxvYWQuY2ZlNzM4MWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBSZXZlYWwoc2l6ZSwgb3JpZ2luKSB7XG4gICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZWwuY2xhc3NOYW1lID0gXCJyZXZlYWwgXCIgKyBzaXplO1xuICAgIGVsLnNldEF0dHJpYnV0ZShcImRhdGEtcmV2ZWFsXCIsIFwiXCIpO1xuICAgIGVsLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJkaWFsb2dcIik7XG4gICAgZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1vcHRpb25zXCIsIFwiY2xvc2VPbkNsaWNrOmZhbHNlO1wiKTtcbiAgICBlbC5yZXZlYWxvYmplY3QgPSB0aGlzO1xuICAgIGVsLmlubmVySFRNTCA9ICcnO1xuICAgIHRoaXMub3JpZ2luID0gb3JpZ2luO1xuICAgIHRoaXMuZWwgPSBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTtcbiAgICBldmVudExpc3RlbmVycyh0aGlzLmVsKTtcbiAgICAkKHRoaXMuZWwpLm9uKCdjbG9zZWQuemYucmV2ZWFsJywgZnVuY3Rpb24oZXZlbnQsIGxhcmdlKSB7XG4gICAgICAgICQodGhpcykuY2xvc2VzdCgnZGl2LnJldmVhbC1vdmVybGF5JykucmVtb3ZlKCk7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICAgICQodGhpcy5lbCkub24oJ2Nsb3NlbWUuemYucmV2ZWFsJywgZnVuY3Rpb24oZXZlbnQsIGxhcmdlKSB7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gY2hhbmdlRm9ybVJlc3VsdCgpIHtcblxuICAgICQoJ2Zvcm1bZm9ybXJlc3VsdD1cImpzb25cIl0nKS5zdWJtaXQoZnVuY3Rpb24oZSkge1xuXG4gICAgICAgIHZhciBmb3JtRWxtID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIHJldmVhbCA9ICQodGhpcykuY2xvc2VzdCgnLnJldmVhbCcpLmdldCgwKS5yZXZlYWxvYmplY3Q7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybVVybCA9ICQoZm9ybUVsbSkuYXR0cignYWN0aW9uJyk7XG4gICAgICAgICAgICB2YXIgZm9ybURhdGEgPSAkKHRoaXMpLnNlcmlhbGl6ZSgpO1xuXG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgIHVybDogZm9ybVVybCxcbiAgICAgICAgICAgICAgICBkYXRhOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICAgICBhc3luYzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RFbG0gPSAkKHJldmVhbC5vcmlnaW4pLmNsb3Nlc3QoJy5mb3JtLWNvbGxlY3Rpb24tYWRkJykuZmluZCgnc2VsZWN0JykuZmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0RWxtLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJzxvcHRpb24+JywgeyB2YWx1ZTogcmVzcG9uc2UuaWQgfSkudGV4dChyZXNwb25zZS5uYW1lKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RFbG0udmFsKHJlc3BvbnNlLmlkKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3JtRWxtLmNsb3Nlc3QoJy5yZXZlYWwnKS5mb3VuZGF0aW9uKCdjbG9zZScpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKFhNTEh0dHBSZXF1ZXN0LCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bilcbiAgICAgICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZXgpIHtcbiAgICAgICAgICAgIGFsZXJ0KGV4Lm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZXZlbnRMaXN0ZW5lcnMoc2NvcGUpIHtcbiAgICBzY29wZSA9IHNjb3BlIHx8IGRvY3VtZW50O1xuICAgIHZhciBkYXRlRm9ybWF0ID0gJ2RkLW1tLXl5JztcbiAgICB2YXIgZGF0ZXBpY2tlclNldHRpbmdzID0ge1xuICAgICAgICBkYXRlRm9ybWF0OiBkYXRlRm9ybWF0LFxuXG4gICAgICAgIHNob3dXZWVrOiB0cnVlLFxuICAgICAgICBudW1iZXJPZk1vbnRoczogMSxcbiAgICAgICAgcHJldlRleHQ6ICcgJyxcbiAgICAgICAgbmV4dFRleHQ6ICcgJyxcbiAgICAgICAgd2Vla0hlYWRlcjogJyAnLFxuICAgICAgICBmaXJzdERheTogMSxcbiAgICAgICAgZGF5TmFtZXM6IFsgJ1pvbmRhZycsICdNYW5kYWFnJywgJ0RpbnNkYWcnLCAnV29lbnNkYWcnLCAnRG9uZGVyZGFnJywgJ1ZyaWpkYWcnLCAnWmF0ZXJkYWcnIF0sXG4gICAgICAgIGRheU5hbWVzTWluOiBbICdabycsICdNYScsICdEaScsICdXbycsICdEbycsICdWcicsICdaYScgXSxcbiAgICAgICAgbW9udGhOYW1lczogWyAnSmFudWFyaScsICdGZWJydWFyaScsICdNYWFydCcsICdBcHJpbCcsICdNZWknLCAnSnVuaScsICdKdWxpJywgJ0F1Z3VzdHVzJywgJ1NlcHRlbWJlcicsICdPa3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJyBdLFxuICAgICAgICBtb250aE5hbWVzU2hvcnQ6IFsgJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYWonLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJywgJ09rdCcsICdOb3YnLCAnRGVjJyBdLFxuICAgICAgICBiZWZvcmVTaG93OiBmdW5jdGlvbihpbnB1dCwgaW5zdCkge1xuICAgICAgICAgICAgJCgnI3VpLWRhdGVwaWNrZXItZGl2JykuYWRkQ2xhc3MoJ3N0YW5kYWxvbmUtZGF0ZXBpY2tlcicpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuXG53aW5kb3cuUmV2ZWFsID0gUmV2ZWFsXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG5cbiAgICB2YXIgcGF0aFRvdWNoTW92ZWQgPSBmYWxzZTtcbiAgICAgICAgJCgnYm9keScpLm9uKCdjbGljayB0b3VjaGVuZCcsICdbZGF0YS1wYXRoXScsIGZ1bmN0aW9uKGUpIHtcblxuICAgICAgICAgICAgaWYgKHBhdGhUb3VjaE1vdmVkICE9IHRydWUpIHtcblxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICQodGhpcykuZGlzYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSAkKHRoaXMpLmF0dHIoXCJkYXRhLXBhdGhcIik7XG4gICAgICAgICAgICAgICAgLy9pZiAocGF0aFswXSAhPT0gJy8nKVxuICAgICAgICAgICAgICAgIC8vICAgIFJvdXRpbmcuZ2VuZXJhdGUocGF0aCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwYXRoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzaXplID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1yZXZlYWwtc2l6ZVwiKTtcbiAgICAgICAgICAgICAgICB2YXIgb3JpZ2luID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciByZXZlYWwgPSBuZXcgUmV2ZWFsKHNpemUgPyBzaXplIDogJ2xhcmdlJywgb3JpZ2luKTtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudFRvT3BlbiA9ICQodGhpcykuYXR0cihcImRhdGEtb3Blbi1lbGVtZW50XCIpO1xuXG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogcGF0aCxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHJldmVhbC5lbCkuZm91bmRhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJChyZXZlYWwuZWwpLmh0bWwoZGF0YSkuZm91bmRhdGlvbignb3BlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnPiBkaXYnLCByZXZlYWwuZWwpLmZvdW5kYXRpb24oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlRm9ybVJlc3VsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRUb09wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGVsZW1lbnRUb09wZW4pLnNlbGVjdDIoJ29wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvY3VzIGZpcnN0IHZpc2libGUgZmllbGQgaW4gZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Zvcm0nKS5maW5kKCcqJykuZmlsdGVyKCc6aW5wdXQ6dmlzaWJsZTpmaXJzdCcpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkub24oJ3RvdWNobW92ZScsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgcGF0aFRvdWNoTW92ZWQgPSB0cnVlO1xuICAgICAgICB9KS5vbigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBwYXRoVG91Y2hNb3ZlZCA9IGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgLyogQWpheGlmeSBmb3JtIHJlcXVpcmVkIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICAgICAgICAgIC0gYXR0cmlidXRlICdkYXRhLWFzeW5jJyBvbiBmb3JtXG4gICAgICAgICAgICAtIGRpdiBpbiB0aGUgZm9ybSB3aXRoIGlkICdmb3JtQm9keSdcbiAgICAgICAgICAgIC0gZGl2IGFib3ZlIHRoZSBmb3JtIHdpdGggaWQgJ2Zvcm1NZXNzYWdlJ1xuICAgICAgICAgKi9cbiAgICAgICAgJCgnYm9keScpLm9uKCdzdWJtaXQnLCAnZm9ybVtkYXRhLWFzeW5jXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwid2Vya3RcIik7XG5cbiAgICAgICAgICAgIHZhciByZWRpcmVjdCA9ICQoJ2J1dHRvblt0eXBlPXN1Ym1pdF1bY2xpY2tlZD1cInRydWVcIl0nKS5hdHRyKCdyZWRpcmVjdCcpO1xuICAgICAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKHRoaXMpO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdzYXZlQW5kQ2xvc2UnLCAocmVkaXJlY3QgPyAnMScgOiAnMCcpKTtcblxuICAgICAgICAgICAgJC5hamF4KHtcblxuICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHR5cGU6ICQodGhpcykuYXR0cignbWV0aG9kJyksXG4gICAgICAgICAgICAgICAgdXJsOiAkKHRoaXMpLmF0dHIoJ2FjdGlvbicpLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhLnJlZGlyZWN0VG9Sb3V0ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gZGF0YS5yZWRpcmVjdFRvUm91dGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5tZXNzYWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAkKCcjZm9ybU1lc3NhZ2UnKS5odG1sKGRhdGEubWVzc2FnZSkuZmFkZUluKCkucmVtb3ZlQ2xhc3MoJ2FsZXJ0JykuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNmb3JtTWVzc2FnZVwiKS5mYWRlT3V0KCdzbG93JylcbiAgICAgICAgICAgICAgICAgICAgfSwgNzAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBqcVhIUi5yZXNwb25zZUpTT04gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChqcVhIUi5yZXNwb25zZUpTT04uaGFzT3duUHJvcGVydHkoJ2Zvcm0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2Zvcm1Cb2R5JykuaHRtbChqcVhIUi5yZXNwb25zZUpTT04uZm9ybSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJCgnI2Zvcm1NZXNzYWdlJykuaHRtbChqcVhIUi5yZXNwb25zZUpTT04ubWVzc2FnZSkuZmFkZUluKCkucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKS5hZGRDbGFzcygnYWxlcnQnKTtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNmb3JtTWVzc2FnZVwiKS5mYWRlT3V0KCdzbG93JylcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChlcnJvclRocm93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCAnZm9ybVtkYXRhLWFzeW5jXSBidXR0b25bdHlwZT1zdWJtaXRdJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKCdidXR0b25bdHlwZT1zdWJtaXRdJywgJCh0aGlzKS5wYXJlbnRzKCdmb3JtW2RhdGEtYXN5bmNdJykpLnJlbW92ZUF0dHIoJ2NsaWNrZWQnKTtcbiAgICAgICAgICAgICQodGhpcykuYXR0cignY2xpY2tlZCcsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwiZm9ybUxvYWQgbG9hZGVkXCIpOyJdLCJzb3VyY2VSb290IjoiIn0=